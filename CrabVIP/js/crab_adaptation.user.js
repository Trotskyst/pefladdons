// ==UserScript==
// @name           pefladaptation
// @namespace      pefl
// @description    adaptaton map
// @include        http://*pefl.*/?adaptation
// @encoding	   windows-1251
// ==/UserScript==

var nationplayers = {
155:2800,
61:2658,
27:2260,
95:2121,
74:1723,
70:1693,
192:1666,
172:1631,
8:1599,
19:1530,
98:1376,
209:1279,
44:1207,
161:1164,
84:1132,
200:1128,
53:1002,
149:1001,
150:947,
139:941,
180:919,
48:900,
18:894,
122:859,
30:799,
171:780,
58:778,
167:769,
93:767,
42:755,
76:733,
12:726,
69:725,
87:689,
201:665,
170:660,
137:645,
64:628,
59:618,
94:614,
181:609,
88:594,
126:589,
51:588,
24:580,
25:576,
11:571,
13:551,
204:544,
129:530,
196:518,
111:504,
166:493,
207:492,
41:466,
73:465,
105:458,
96:456,
2:455,
214:435,
100:425,
154:408,
202:391,
1:379,
91:368,
47:347,
145:337,
160:334,
66:333,
191:288,
195:282,
147:280,
9:271,
123:266,
152:253,
50:221,
35:217,
162:207,
75:200,
153:122,
36:112,
118:107,
80:79,
45:78,
134:62,
67:58,
31:55,
72:55,
81:55,
5:54,
188:53,
21:52,
71:50,
92:50,
164:49,
112:46,
37:44,
97:44,
212:44,
83:40,
211:40,
143:39,
132:38,
110:37,
178:37,
119:36,
199:36,
101:34,
106:33,
182:33,
108:32,
85:31,
130:31,
115:30,
138:28,
217:28,
127:27,
158:27,
193:27,
32:26,
103:26,
184:25,
151:24,
190:24,
4:23,
60:23,
156:22,
114:19,
39:17,
136:16,
215:16,
90:15,
148:14,
65:13,
120:11,
49:10,
109:10,
26:9,
40:9,
169:8,
7:7,
17:7,
56:7,
62:7,
79:7,
15:6,
133:5,
140:5,
142:5,
168:5,
185:5,
205:5,
89:4,
107:4,
141:4,
186:4,
218:4,
43:3,
63:3,
82:3,
86:3,
104:3,
116:3,
174:3,
179:3,
213:3,
10:2,
20:2,
77:2,
121:2,
159:2,
173:2,
183:2,
187:2,
14:1,
16:1,
22:1,
38:1,
68:1,
99:1,
135:1,
177:1,
194:1,
3:0,
6:0,
23:0,
28:0,
29:0,
34:0,
46:0,
54:0,
55:0,
78:0,
102:0,
113:0,
117:0,
124:0,
125:0,
128:0,
131:0,
144:0,
157:0,
163:0,
165:0,
175:0,
176:0,
189:0,
203:0,
208:0
}
var nationteamnum = {
214:12,
209:36,
207:18,
204:22,
202:16,
201:20,
200:36,
196:28,
195:12,
192:38,
191:12,
181:28,
180:32,
172:66,
171:28,
170:26,
167:24,
166:24,
161:42,
160:12,
155:110,
154:18,
152:12,
150:36,
149:36,
147:12,
145:12,
139:32,
137:12,
129:16,
126:16,
123:10,
122:34,
111:20,
105:20,
100:20,
98:52,
96:14,
95:78,
94:24,
93:22,
91:16,
88:24,
87:32,
84:38,
76:34,
74:76,
73:20,
70:60,
69:24,
66:12,
64:20,
61:114,
59:26,
58:28,
53:44,
51:32,
50:14,
48:32,
47:12,
44:36,
42:28,
41:16,
30:32,
27:62,
25:16,
24:28,
19:68,
18:36,
13:24,
12:38,
11:20,
9:10,
8:44,
2:18,
1:12
}
var peflnation ={
//0:'Àôãàíèñòàí',
1:'Àëáàíèÿ',
2:'Àëæèð',
3:'Âîñòî÷íîå Ñàìîà',
4:'Àíäîððà',
5:'Àíãîëà',
6:'Àíãóèëëà',
7:'Àíòèãóà',
8:'Àðãåíòèíà',
9:'Àðìåíèÿ',
10:'Àðóáà',
11:'Àâñòðàëèÿ',
12:'Àâñòðèÿ',
13:'Àçåðáàéäæàí',
14:'Áàãàìû',
15:'Áàõðåéí',
16:'Áàíãëàäåø',
17:'Áàðáàäîñ',
18:'Áåëàðóñü',
19:'Áåëüãèÿ',
20:'Áåëèç',
21:'Áåíèí',
22:'Áåðìóäû',
23:'Áóòàí',
24:'Áîëèâèÿ',
25:'Áîñíèÿ',
26:'Áîòñâàíà',
27:'Áðàçèëèÿ',
28:'Âèðãèíñêèå î-âà',
29:'Áðóíåé',
30:'Áîëãàðèÿ',
31:'Áóðêèíà Ôàñî',
32:'Áóðóíäè',
34:'Êîìáîäæà',
35:'Êàìåðóí',
36:'Êàíàäà',
37:'Êàáî-Âåðäå',
38:'Êàéìàíîâû î-âà',
39:'ÖÀÐ',
40:'×àä',
41:'×èëè',
42:'Êèòàé',
43:'Òàéâàíü',
44:'Êîëóìáèÿ',
45:'Êîíãî',
46:'Î-âà Êóêà',
47:'Êîñòà Ðèêà',
48:'Õîðâàòèÿ',
49:'Êóáà',
50:'Êèïð',
51:'×åõèÿ',
53:'Äàíèÿ',
54:'Äæèáóòè',
55:'Äîìèíèêà',
56:'Äîìèíèêàíñêàÿ ð-êà',
58:'Ýêâàäîð',
59:'Åãèïåò',
60:'Ñàëüâàäîð',
61:'Àíãëèÿ',
62:'Ýêâ. Ãâèíåÿ',
63:'Ýðèòðåÿ',
64:'Ýñòîíèÿ',
65:'Ýôèîïèÿ',
66:'Ìàêåäîíèÿ',
67:'Ôàðåðñêèå î-âà',
68:'Ôèäæè',
69:'Ôèíëÿíäèÿ',
70:'Ôðàíöèÿ',
71:'Ãàáîí',
72:'Ãàìáèÿ',
73:'Ãðóçèÿ',
74:'Ãåðìàíèÿ',
75:'Ãàíà',
76:'Ãðåöèÿ',
77:'Ãðåíàäà',
78:'Ãóàì',
79:'Ãâàòåìàëà',
80:'Ãâèíåÿ',
81:'Ãâèíåÿ-Áèñàó',
82:'Ãàéàíà',
83:'Ãàèòè',
84:'Ãîëëàíäèÿ',
85:'Ãîíäóðàñ',
86:'Ãîí-Êîíã',
87:'Âåíãðèÿ',
88:'Èñëàíäèÿ',
89:'Èíäèÿ',
90:'Èíäîíåçèÿ',
91:'Èðàí',
92:'Èðàê',
93:'Èðëàíäèÿ',
94:'Èçðàèëü',
95:'Èòàëèÿ',
96:'Êîò`ä`Èâóàð',
97:'ßìàéêà',
98:'ßïîíèÿ',
99:'Èîðäàíèÿ',
100:'Êàçàõñòàí',
101:'Êåíèÿ',
102:'Êóâåéò',
103:'Êèðãèçèÿ',
104:'Ëàîñ',
105:'Ëàòâèÿ',
106:'Ëèâàí',
107:'Ëåñîòî',
108:'Ëèáåðèÿ',
109:'Ëèâèÿ',
110:'Ëèõòåíøòåéí',
111:'Ëèòâà',
112:'Ëþêñåìáóðã',
113:'Ìàêàî',
114:'Ìàäàãàñêàð',
115:'Ìàëàâè',
116:'Ìàëàéçèÿ',
117:'Ìàëüäèâû',
118:'Ìàëè',
119:'Ìàëüòà',
120:'Ìàâðèòàíèÿ',
121:'Ìàâðèêèé',
122:'Ìåêñèêà',
123:'Ìîëäîâà',
124:'Ìîíãîëèÿ',
125:'Ìîíñåððàò',
126:'Ìàðîêêî',
127:'Ìîçàìáèê',
128:'Ìüÿíìàð',
129:'Ñåâåðíàÿ Èðëàíäèÿ',
130:'Íàìèáèÿ',
131:'Íåïàë',
132:'Êþðàñàî',
133:'Íîâàÿ Êàëåäîíèÿ',
134:'Íîâàÿ Çåëàíäèÿ',
135:'Íèêàðàãóà',
136:'Íèãåð',
137:'Íèãåðèÿ',
138:'Ñåâåðíàÿ Êîðåÿ',
139:'Íîðâåãèÿ',
140:'Îìàí',
141:'Ïàêèñòàí',
142:'Ïàëåñòèíà',
143:'Ïàíàìà',
144:'Ïàïóà Íîâàÿ Ãâèíåÿ',
145:'Ïàðàãâàé',
147:'Ïåðó',
148:'Ôèëèïïèíû',
149:'Ïîëüøà',
150:'Ïîðòóãàëèÿ',
151:'Ïóýðòî-Ðèêî',
152:'Êàòàð',
153:'ÄÐ Êîíãî',
154:'Ðóìûíèÿ',
155:'Ðîññèÿ',
156:'Ðóàíäà',
157:'Çàï. Ñàìîà',
158:'Ñàí-Ìàðèíî',
159:'Òîìå',
160:'Ñàóäîâñêàÿ Àðàâèÿ',
161:'Øîòëàíäèÿ',
162:'Ñåíåãàë',
163:'Ñåéøåëüñêèå î-âà',
164:'Ñüåððà-Ëåîíå',
165:'Ñèíãàïóð',
166:'Ñëîâàêèÿ',
167:'Ñëîâåíèÿ',
168:'Ñîëîìîíîâû î-âà',
169:'Ñîìàëè',
170:'ÞÀÐ',
171:'Þæíàÿ Êîðåÿ',
172:'Èñïàíèÿ',
173:'Øðè-Ëàíêà',
174:'Ñåíò-Êèòòñ',
175:'Ëóñèÿ',
176:'Ñåíò-Âèíñåíò',
177:'Ñóäàí',
178:'Ñóðèíàì',
179:'Ñâàçèëåíä',
180:'Øâåöèÿ',
181:'Øâåéöàðèÿ',
182:'Ñèðèÿ',
184:'Òàäæèêèñòàí',
185:'Òàíçàíèÿ',
186:'Òàèëàíä',
188:'Òîãî',
189:'Òîíãà',
190:'Òðèíèäàä è Òîáàãî',
191:'Òóíèñ',
192:'Òóðöèÿ',
193:'Òóðêìåíèñòàí',
194:'Êàèêîñ',
195:'ÎÀÝ',
196:'ÑØÀ',
199:'Óãàíäà',
200:'Óêðàèíà',
201:'Óðóãâàé',
202:'Óçáåêèñòàí',
203:'Âàíóàòó',
204:'Âåíåñóýëà',
205:'Âüåòíàì',
207:'Óýëüñ',
208:'Éåìåí',
209:'Ñåðáèÿ',
153:'Çàèð',
211:'Çàìáèÿ',
212:'Çèìáàáâå',
213:'Ãâàäåëóïà',
214:'×åðíîãîðèÿ',
215:'Êîìîðñêèå îñòðîâà',
216:'Òàèòè',
217:'Àôãàíèñòàí'
}

var peflcountry=[1,2,8,9,11,12,13,18,19,24,25,27,30,41,42,44,47,48,50,51,53,58,59,61,64,66,69,70,73,74,76,84,87,88,91,93,94,95,98,100,105,111,122,123,126,129,137,139,145,147,149,150,152,154,155,160,161,166,167,170,171,172,180,181,191,192,195,196,200,201,202,204,96,207,209,214]
var pfc = []
$().ready(function(){
	$('td.back4').html('<b>Êàðòà àäàïòàöèè</b><br>')
	$.getScript("js/adaptation5.en.js", function() {
		for (f=0;f<76;f++) {
			pfc[f] = []
			for(i in peflnation){
				pfc[f][i] = {'name':peflnation[i]}
			}
		}
		for (i in s_adaptationMap) for(j in s_adaptationMap[i]) {
			if(pfc[j][i]==undefined) pfc[j][i] = {'name':'õç.'+j+'.'+i};
			pfc[j][i]['num'] = parseInt(s_adaptationMap[i][j])
			pfc[j][i]['id'] = i
		}
		PrintAd()
	});
});

function sNum(i, ii) { // Ïî SumSkills (óáûâàíèþ)
    if 		(i.num < ii.num)	return  1
    else if	(i.num > ii.num)	return -1
    else						return  0
}

function PrintAd(){
	var mtext = ''
	for( i in pfc){
		var pforn_sum = 0
		var text2 = '' 
		var pfcs = pfc[i].sort(sNum)
		for(j in pfcs){
			var pforn = pfcs[j]['num']*nationplayers[pfcs[j]['id']]/10
			pforn_sum += pforn
			text2 += '<tr align=right id="c'+i+'"'+(parseInt(localStorage.mycountry) == peflcountry[i] ? '' : ' style="display: none;"')+'>'
			text2 += '<td width=10%>'+pfcs[j]['num'] +'0%</td>'
			text2 += '<td align=left>'+ pfcs[j]['name']+'</td>'
			text2 += '<td>'+nationplayers[pfcs[j]['id']]+'</td>'
			text2 += '<td>'+pforn.toFixed(2).replace('.',',')+'</td>'
			text2 += '<td>'+(pforn/nationteamnum[peflcountry[i]]).toFixed(2).replace('.',',')+'</td>'
			text2 += '<td>'+'</td>'
			text2 += '</tr>'
		}
		var text1 = '<tr align=right id="cname" class=back3>'
		text1 += '<td align=left colspan=3 width=40%><a href="javascript:void(ShowC(\''+i+'\'))">'+s_adaptationResultList[i]+' ('+peflnation[peflcountry[i]]+')</a></td>'
		text1 += '<td>'+pforn_sum.toFixed(2).replace('.',',')+'</td>'
		text1 += '<td>'+(pforn_sum/nationteamnum[peflcountry[i]]).toFixed(2).replace('.',',')+'</td>'
		text1 += '<td align=left width=30%>'+nationteamnum[peflcountry[i]]+'</td>'
		text1 += '</tr>'
		if(parseInt(localStorage.mycountry) == peflcountry[i]) mtext = text1+text2+mtext
		else mtext += text1+text2
	}
	mtext = '<table width=100%><tr><td colspan=2>Ñòðàíà</td><td width=10%>èãðîêîâ</td><td>äëÿ&nbsp;ñòðàíû</td><td>äëÿ&nbsp;êîìàíäû</td><td>êîìàíä</td></tr>'+mtext+'</table>'
	$('td.back4').append('<table width=100%>'+mtext+'</table>')
}
function ShowC(n){
	if(String($('tr#c'+n+':first').attr('style')).indexOf('display: none') == -1) $('tr#c'+n).hide()
	else $('tr#c'+n).show()
}
